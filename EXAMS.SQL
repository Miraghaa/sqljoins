
CREATE DATABASE STHW
USE STHW

CREATE TABLE STUDENTS(
ID INT PRIMARY KEY IDENTITY,
FULLNAME NVARCHAR(50) NOT NULL,
POINT FLOAT NOT NULL,
GROUPID INT FOREIGN KEY REFERENCES [GROUP](ID)
)
INSERT INTO STUDENTS
VALUES('MURAD ASLANOV','70','3')

CREATE TABLE [GROUP](
ID INT PRIMARY KEY IDENTITY,
GROUPNO NVARCHAR(30)
)
INSERT INTO [GROUP]
VALUES('P234')

CREATE TABLE EXAMS(
ID INT PRIMARY KEY IDENTITY,
SubjectName NVARCHAR (50) NOT NULL,
STARTDATE NVARCHAR(30)NOT NULL,
ENDDATE NVARCHAR(40) NOT NULL
)
INSERT INTO EXAMS
VALUES('DERS5','11','12'),('DERS4','11','12')



CREATE TABLE STUDENTSEXAMS(
ID INT PRIMARY KEY IDENTITY,
STUDENTID INT FOREIGN KEY REFERENCES STUDENTS(ID),
EXAMID INT FOREIGN KEY REFERENCES EXAMS(ID),
RESULTPOINT FLOAT NOT NULL
)


--SELECT S.FULLNAME,G.GROUPNO FROM STUDENTS AS S
--JOIN [GROUP] AS G
--ON
--G.ID = S.GROUPID

--SELECT S.ID,S.FULLNAME,COUNT(SE.ID)'EXAMNO' FROM STUDENTS AS S
--JOIN STUDENTSEXAMS AS SE
--ON
--S.ID= SE.STUDENTID
--GROUP BY S.ID,S.FULLNAME

--SELECT SE.ID,S.FULLNAME,G.GROUPNO FROM STUDENTSEXAMS AS SE
--JOIN STUDENTS AS S
--ON
--S.ID = SE.STUDENTID
--JOIN [GROUP] AS G
--ON
--G.ID = S.GROUPID

--SELECT S.FULLNAME, AVG(SE.RESULTPOINT) FROM STUDENTS AS S
--JOIN STUDENTSEXAMS AS SE
--ON
--SE.STUDENTID = S.ID
--GROUP BY S.FULLNAME

--SELECT SE.EXAMID,E.SubjectName ,COUNT(SE.STUDENTID) 'EXAMPLUS'  FROM STUDENTSEXAMS AS SE
--JOIN EXAMS AS E
--ON
--E.ID = SE.EXAMID
--WHERE DATEDIFF(DAY,E.STARTDATE,GETDATE())=1
--GROUP BY SE.EXAMID,E.SubjectName
